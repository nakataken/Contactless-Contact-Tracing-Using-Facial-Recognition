<%- include("../partials/header.ejs", {title:"Register"}) %>

<h1>Contact Information Gathering</h1>
<a href="/visitor/login">Have account? Login.</a>

<form action="/visitor/register" method="POST">
    <div>
        <label for="fname">First Name: </label>
        <input type="text" name="fname" <% if(typeof(fname) != "undefined") { %> value="<%=fname%>" <% } %> required>
    </div>
    <div>
        <label for="mi">Middle Initial: </label>
        <input type="text" name="mi" <% if(typeof(mi) != "undefined") { %> value="<%=mi%>" <% } %>>
    </div>
    <div>
        <label for="lname">Last Name: </label>
        <input type="text" name="lname" <% if(typeof(lname) != "undefined") { %> value="<%=lname%>" <% } %> required>
    </div>
    <div>
        <label for="email">Email: </label>
        <input type="email" name="email" <% if(typeof(email) != "undefined") { %> value="<%=email%>" <% } %> required>
    </div>
    <% if(typeof(emailError) != "undefined") {%>
    <p class="text-danger">
        <%=emailError%>
    </p>
    <% } %>
    <div>
        <label for="contact">Contact No.: </label>
        <p>+63 <input type="number" name="contact" maxlength="10" <% if(typeof(contact) != "undefined") { %> value="<%=contact%>" <% } %> oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" maxlength="9" required></p>
    </div>
    <% if(typeof(contactError) != "undefined") {%>
        <p class="text-danger">
            <%=contactError%>
        </p>
    <% } %>
    <div>
        <label for="bdate">Birthdate</label>
        <input id="datefield" type="date" name="bdate" max="" <% if(typeof(bdate) != "undefined") { %> value="<%=bdate%>" <% } %> required>
    </div>
    <!-- Change to drop down -->
    <div>
        <label for="barangay">Barangay: </label>
        <input type="text" name="barangay" required>
    </div>
    <div>
        <label for="city">City/Municipality: </label>
        <input type="text" name="city" required>
    </div>
    <div>
        <label for="province">Province: </label>
        <input type="text" name="province" required>
    </div>
    <!--  -->
    <div>
        <label for="pass">Password</label>
        <input id="pass" type="password" name="pass" minlength="6" required>
    </div>
    <div>
        <label for="cpass">Confirm Password</label>
        <input id="cpass" type="password" name="cpass" required>
        <span id="message"></span>
    </div>
    <button type="submit">Register</button>
</form>

<!-- <script>
    // const form = document.querySelector('form');
    // // console.log(form);
    // form.addEventListener('submit', async (e) => {
    //     e.preventDefault();
    //     const fname = form.fname.value;
    //     console.log(fname);
    //     const mi = form.mi.value;
    //     const lname = from.lname.value;
    //     const contact = form.contact.value;
    //     const bdate = form.bdate.value;
    //     const barangay = form.barangay.value;
    //     const city = form.city.value;
    //     const province = form.province.value;
    //     const email = form.email.value;
    //     const pass = form.password.value;
    //     const cpass = form.cpass.value;

    //     // Fetch API to post data to server
    //     try {
    //         const res = await fetch('/visitor/register', {
    //             method: 'POST',
    //             body: JSON.stringify({
    //                 fname, mi, lname, contact, bdate, barangay, city, province, email, pass
    //             }),
    //             headers: {'Content-Type': 'application/json'}
    //         });
    //     } catch (error) {
    //         console.log(error);
    //     }
    // });
</script> -->

<script>
    // Script for matching password
    // Change error message here
    $('#pass, #cpass').on('keyup', function () {
        if ($('#pass').val() == $('#cpass').val()) {
            $('#message').html('Matching').css('color', 'green');
        } else
            $('#message').html('Not Matching').css('color', 'red');
    });
</script>

<script>
    // Script for max bdate 
    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth() + 1;
    var yyyy = today.getFullYear();

    if (dd < 10)
        dd = '0' + dd;

    if (mm < 10)
        mm = '0' + mm;

    today = yyyy + '-' + mm + '-' + dd;
    document.getElementById("datefield").setAttribute("max", today);
</script>

<%- include("../partials/footer.ejs") %>