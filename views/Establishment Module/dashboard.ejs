<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Establishment Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" >
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/portal.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel='stylesheet' href='https://maxst.icons8.com/vue-static/landings/line-awesome/font-awesome-line-awesome/css/all.min.css'><link rel="stylesheet" href="./style.css">
    
    <script src="/js/jquery.min.js"></script>
    <script src="https://unpkg.com/vue@3"></script>
</head>
<body>

    <div id="app">
        <div v-if="establishment">
            <h1> Total visitors logged in this establishment: {{recordsCount}} </h1>
        </div>

        <div>
            <input type="search" v-model="search">
        </div>

        <table>
            <thead>
                <td>Name</td>
                <td>Date & Time</td>
            </thead>
            <tr v-for="log in filteredLogs" :key="log._id">
                <td>{{log.name}}</td>
                <td>{{log.date}}</td>
            </tr>
    </div>

<script>
    const app = Vue.createApp({
        data() {
            return {
                establishment: JSON.parse('<%- JSON.stringify(establishment) %>'),
                recordsCount: JSON.parse('<%- JSON.stringify(recordsCount) %>'),
                logs: JSON.parse('<%- JSON.stringify(logs) %>'),
                search: ""
            }
        },
        computed: {
            filteredLogs() {
                return this.logs.filter(log => {
                    return log.name.includes(this.search.toUpperCase())
                })
            }
        }
    });
    app.mount('#app');
</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" ></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script  src="/js/sidepanel.js"></script>
</body>
</html>