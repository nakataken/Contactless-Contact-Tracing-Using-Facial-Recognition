<%- include("../partials/header.ejs", {title:"Establishments List"}) %>
    <div id="app">
        <div v-if="admin"  class="home_adm  container-fluid p-0">   
            <%- include("../partials/navbar.ejs"); %>
            <div class="app-wrapper">
                <div class="app-content pt-3 p-md-3 p-lg-4">
                    <div class="container-xl">
                       
                        <div class="head container" >
                            <div class="table-responsive  col-12 mx-auto p-0 mt-5">
                                <table  class="table app-table-hover mb-0">
                                    <thead>
                                        <th class="cell">Establishment Name</th>
                                        <th class="cell">Establishment Owner</th>
                                        <th class="cell">Establishment Address</th>
                                        <th class="cell">Establishment Email</th>
                                        <th class="cell">Establishment Contact</th>
                                        <th class="cell">Limited for vaccinated person (Check/Ekis)</th>
                                    </thead>
                    
                                    <tr v-for="establishment in establishments" :key="establishment._id">
                                        <td class="cell">{{establishment.name}}</td>
                                        <td class="cell">{{establishment.owner}}</td>
                                        <td class="cell">{{establishment.address}}</td>
                                        <td class="cell">{{establishment.email}}</td>
                                        <td class="cell">{{establishment.contact}}</td>
                                        <td class="cell" v-if="establishment.limitVacinated">Check</td>
                                        <td class="cell" v-else>Ekis</td>
                                    </tr>
                                </table>
                            </div>
                            
                            
                       </div>   
                    </div>
                </div>
            </div>
            
        </div>
    </div>

<script>
    const app = Vue.createApp({
        data() {
            return {
                admin: JSON.parse('<%- JSON.stringify(admin) %>'),
                establishments: [],
                max: "",
                reloadContent: async () => {
                    const response = await fetch("/admin/establishments");
                    const result = await response.json();
                    this.establishments = await result.establishments;  
                }
            }
        },
        methods: {
            
        },
        mounted() {
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth() + 1;
            var yyyy = today.getFullYear();

            if (dd < 10) dd = '0' + dd;

            if (mm < 10) mm = '0' + mm;

            today = yyyy + '-' + mm + '-' + dd;

            this.max = today;
            this.reloadContent();
        },
        computed: {

        }
    });

    app.mount('#app');
</script>


<%- include("../partials/footer.ejs"); %>
